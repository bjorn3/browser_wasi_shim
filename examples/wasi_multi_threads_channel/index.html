<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">

<p id="note">
  ####
</p>

<script type="module">
  import { File, OpenFile, ConsoleStdout, PreopenDirectory, WASIFarm, WASIFarmAnimal } from "../../dist/index.js";

  const farm = new WASIFarm(
    new OpenFile(new File([])), // stdin
    ConsoleStdout.lineBuffered(msg => console.log(`[WASI stdout] ${msg}`)),
    ConsoleStdout.lineBuffered(msg => console.warn(`[WASI stderr] ${msg}`)),
    [],
    { debug: true },
  );

  const worker = new Worker("./worker.js", { type: "module" });

  worker.postMessage({
    wasi_ref: farm.get_ref(),
  });
</script>
</body>
</html>
